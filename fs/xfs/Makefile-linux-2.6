#!smake
#
# Makefile for SGI xFS
#
# $Revision: 1.11 $
DEPTH?=../..
include ${DEPTH}/kcommondefs
KPATH=$(TOP)/fs/xfs
.PATH:$(KPATH)

KCOPTS=-fullwarn

XFS_NAME=xfs.a
XFS_CSRCS=	byte_to_bits.c \
		xfs_alloc.c \
		xfs_alloc_btree.c \
		xfs_bio.c \
		xfs_bmap.c \
		xfs_bmap_btree.c \
		xfs_btree.c \
		xfs_buf_item.c \
		xfs_dir.c \
		xfs_dir_btree.c \
		xfs_extfree_item.c \
		xfs_ialloc.c \
		xfs_iget.c \
		xfs_inode.c \
		xfs_inode_item.c \
		xfs_iunlink_item.c \
		xfs_log.c \
		xfs_mount.c \
		xfs_print.c \
		xfs_rtalloc.c \
		xfs_rw.c \
		xfs_trans.c \
		xfs_trans_ail.c \
		xfs_trans_async.c \
		xfs_trans_buf.c \
		xfs_trans_extfree.c \
		xfs_trans_inode.c \
		xfs_trans_item.c \
		xfs_trans_iunlink.c \
		xfs_vfsops.c \
		xfs_vnodeops.c
# not ready yet: xfs_dir.c, xfs_dir_btree.c

XFS_OBJS=$(XFS_CSRCS:.c=.o)
$(XFS_NAME):$(XFS_NAME)($(XFS_OBJS)) MAKELIB

TARGETS=$(XFS_NAME)

LINTNAME=xfs
CFILES=$(XFS_CSRCS)
HFILES=	xfs_ag.h \
	xfs_alloc.h \
	xfs_alloc_btree.h \
	xfs_bio.h \
	xfs_bmap.h \
	xfs_bmap_btree.h \
	xfs_btree.h \
	xfs_buf_item.h \
	xfs_dinode.h \
	xfs_dir.h \
	xfs_dir_btree.h \
	xfs_error.h \
	xfs_extfree_item.h \
	xfs_ialloc.h \
	xfs_imap.h \
	xfs_inode.h \
	xfs_inode_item.h \
	xfs_inum.h \
	xfs_iunlink_item.h \
	xfs_log.h \
	xfs_log_priv.h \
	xfs_mount.h \
	xfs_print.h \
	xfs_rtalloc.h \
	xfs_rw.h \
	xfs_sb.h \
	xfs_trans.h \
	xfs_trans_priv.h \
	xfs_types.h

#
# Rules
#
include ${DEPTH}/kcommonrules

$(KCOMMONPREF)default:$(TARGETS)
	${KLINKINSTALL} ${TARGETS}

$(KCOMMONPREF)install: $(KCOMMONPREF)default
	${KINSTALL} ${XFS_NAME}
	${KDEVINSTALL} ${TARGETS}

headers!
	$(INSTALL) -m 444 -F /usr/include/sys/fs $(HFILES)
